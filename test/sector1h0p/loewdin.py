#!/usr/bin/env python

from numpy import *
from scipy.linalg import *
from math import *

N = 8
C = matrix([
 [-4.28007e-01  +5.62847e-01j, -3.22895e-06  +4.24620e-06j,  1.11785e-11  +9.16704e-12j, +1.70364e-03  -2.24035e-03j,  7.07105e-01  +        0.0j,  5.33450e-06  -2.18804e-12j, -2.33543e-11  +4.15624e-11j, -2.81456e-03  +3.35078e-11j],
 [ 7.07105e-01  +        0.0j,  5.33451e-06  +2.18729e-12j, -2.33538e-11  -4.15611e-11j, -2.81456e-03  -3.35086e-11j,  4.27989e-01  +5.62860e-01j,  3.22882e-06  +4.24630e-06j, -1.11773e-11  +9.16513e-12j, -1.70357e-03  -2.24040e-03j],
 [-6.84295e-06  +5.11177e-12j,  7.07107e-01  +        0.0j, -1.85157e-07  -7.85846e-08j, +6.28225e-06  -8.92172e-12j,  6.77454e-06  +9.65489e-07j, -7.00033e-01  -9.97670e-02j,  7.35863e-08  -2.46387e-07j, -6.21937e-06  -8.86382e-07j],
 [-6.77455e-06  +9.65422e-07j,  7.00034e-01  -9.97601e-02j, -7.35840e-08  -2.46389e-07j, +6.21937e-06  -8.86320e-07j, -6.84295e-06  -5.11195e-12j,  7.07107e-01  +        0.0j, -1.85156e-07  +7.85839e-08j,  6.28225e-06  +8.92231e-12j],
 [ 2.24064e-13  -6.06194e-12j, -3.88978e-08  +6.99114e-08j,  8.21250e-01  +        0.0j, +2.94565e-12  -6.90786e-11j,  1.58770e-11  -2.46792e-12j, -1.50991e-08  +1.55445e-07j, -3.89246e-01  -4.17176e-01j,  6.55759e-11  -3.06236e-11j],
 [-1.58592e-11  -2.58511e-12j,  1.40488e-08  +1.56018e-07j,  3.97492e-01  -4.14727e-01j, -6.53583e-11  -3.14508e-11j,  3.23579e-13  +6.05788e-12j, -3.88439e-08  -6.88751e-08j,  8.18536e-01  +        0.0j,  3.18183e-12  +6.89095e-11j],
 [ 3.07086e-03  -4.76028e-11j, -8.61471e-06  -2.18342e-11j,  1.05574e-10  +2.54320e-11j, +7.07101e-01  +        0.0j,  9.45656e-04  -2.92163e-03j, -2.65281e-06  +8.19591e-06j,  4.19955e-11  -4.71040e-11j,  2.17748e-01  -6.72737e-01j],
 [ 3.07088e-03  +2.72062e-11j, -8.61461e-06  +7.44733e-13j,  5.77479e-11  -2.54487e-11j, +7.07105e-01  +        0.0j, -9.45837e-04  +2.92155e-03j,  2.65334e-06  -8.19585e-06j, -8.31726e-12  +1.08272e-10j, -2.17790e-01  +6.72720e-01j]
])

S = dot(C.H,C)

lam, UL, U = eig(S,left=True,right=True)

UH = matrix(U).H

print dot(UH,U)
exit()

S12_inv_diag = zeros((N,N))
for i in xrange(0,N):
	S12_inv_diag[i,i] = 1.0/sqrt(lam[i])
print S12_inv_diag

# U S12_inv_diag UH

S_12 = dot(U.T, dot(S12_inv_diag, UH))

print S_12

print '=================================='

C_orth = dot(S_12, C)

print dot(C_orth.H, C_orth)
